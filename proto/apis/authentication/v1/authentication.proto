syntax = "proto3";
import "errors/v1/errors.proto";

package authentication.v1;

message AuthenticatedData {
  string sub = 1;
  int32 exp = 2;
}

message Authenticated {
  string jwt_string = 1;
  AuthenticatedData data = 2;
}

message CreateAuthenticationWithFirebaseRequest {
  string firebase_jwt_string = 1;
}

message CreateAuthenticationWithFirebaseResponse {
  oneof response {
    Authenticated ok = 1;
    errors.v1.BasicError error = 2;
  }
}

message UpdateRightOfUserRequest {
  enum MutationType {
    MUTATION_TYPE_UNSPECIFIED = 0;
    MUTATION_TYPE_ADD = 1;
    MUTATION_TYPE_DELETE = 2;
  }
  string user_id = 1;
  string right = 2;
  MutationType mutation_type = 3;
}


message UpdateRightOfUserResponse {
  oneof response {
    string ok = 1;
    errors.v1.BasicError error = 2;
  }
}
